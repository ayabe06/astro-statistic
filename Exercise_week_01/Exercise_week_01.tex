\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Keep aspect ratio if custom image width or height is specified
    \setkeys{Gin}{keepaspectratio}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \usepackage{ctex}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro

    \usepackage{iftex}
    \ifPDFTeX
        \usepackage[T1]{fontenc}
        \IfFileExists{alphabeta.sty}{
              \usepackage{alphabeta}
          }{
              \usepackage[mathletters]{ucs}
              \usepackage[utf8x]{inputenc}
          }
    \else
        \usepackage{fontspec}
        \usepackage{unicode-math}
    \fi

    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage{array}     % table support for pandoc >= 2.11.3
    \usepackage{calc}      % table minipage width calculation for pandoc >= 2.11.1
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{soul}      % strikethrough (\st) support for pandoc >= 3.0.0
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}

    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \makeatletter
    \newsavebox\pandoc@box
    \newcommand*\pandocbounded[1]{%
      \sbox\pandoc@box{#1}%
      % scaling factors for width and height
      \Gscale@div\@tempa\textheight{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
      \Gscale@div\@tempb\linewidth{\wd\pandoc@box}%
      % select the smaller of both
      \ifdim\@tempb\p@<\@tempa\p@
        \let\@tempa\@tempb
      \fi
      % scaling accordingly (\@tempa < 1)
      \ifdim\@tempa\p@<\p@
        \scalebox{\@tempa}{\usebox\pandoc@box}%
      % scaling not needed, use as it is
      \else
        \usebox{\pandoc@box}%
      \fi
    }
    \makeatother

    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{Exercise\_week\_01}
    
    
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.61,0.40,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.80,0.25,0.22}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.46,0.46,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.41,0.47,0.13}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.36,0.12}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.52,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{0.89,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@ges}{\let\PY@bf=\textbf\let\PY@it=\textit}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb.
    \makeatletter
        \newbox\Wrappedcontinuationbox
        \newbox\Wrappedvisiblespacebox
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}}
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}}
        \newcommand*\Wrappedcontinuationindent {3ex }
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox}
        % Take advantage of the already applied Pygments mark-up to insert
        % potential linebreaks for TeX processing.
        %        {, <, #, %, $, ' and ": go to next line.
        %        _, }, ^, &, >, - and ~: stay at end of broken line.
        % Use of \textquotesingle for straight quote.
        \newcommand*\Wrappedbreaksatspecials {%
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}%
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}%
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}%
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}%
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}%
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}%
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}%
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}%
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}%
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}%
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}%
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}%
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}%
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}%
        }
        % Some characters . , ; ? ! / are not pygmentized.
        % This macro makes them "active" and they will insert potential linebreaks
        \newcommand*\Wrappedbreaksatpunct {%
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}%
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}%
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}%
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}%
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}%
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}%
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}%
            \catcode`\.\active
            \catcode`\,\active
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active
            \lccode`\~`\~
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%

        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}

    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \section{Statistical Methods in Astrophysics
Exercises}\label{statistical-methods-in-astrophysics-exercises}

\subsection{Week 01: Introduction}\label{week-01-introduction}

\subsubsection{Personal Information}\label{personal-information}

\textbf{Name:} 刘乐融

\textbf{Student ID:} 2024011182

    \subsubsection{\texorpdfstring{Exercise 1: Monte-Carlo \(\pi\)
estimation with error
analysis}{Exercise 1: Monte-Carlo \textbackslash pi estimation with error analysis}}\label{exercise-1-monte-carlo-pi-estimation-with-error-analysis}

\paragraph{Question 1.1: ``Hit-or-Miss''
method}\label{question-1.1-hit-or-miss-method}

The Monte-Carlo ``\textbf{Hit-or-Miss}'' method is a technique for
estimating the area of a complex shape by generating random points
within a known bounding rectangle and counting how many of those points
fall within the shape.

\textbf{Idea:} estimate the value of \(\pi\) by simulating random points
in a unit square and determining the fraction that falls within a
quarter circle inscribed within that square.

\textbf{Tasks:} 1. Write a function to estimate the value of \(\pi\)
using ``Hit-or-Miss'' in the unit square (\(x, y \in [0, 1)\)). The
function should take the number of random points to generate and random
seed as arguments and return the estimated value of \(\pi\). 2. For each
\(N\) in \(\{10^2, 10^3, 10^4, 10^5, 10^6\}\), plot the relative error
of the \(\pi\) estimation (\(|\hat{\pi} - \pi| / \pi\), where
\(\hat{\pi}\) is the estimated \(\pi\) value) as a function of \(N\).
Choose appropriate scales for both axes. 3. Repeat the above step for 10
different random seeds and plot their mean relative errors as a function
of \(N\). Overplot the standard deviations as error bars. 4. Guess the
relationship between the mean relative error and \(N\) and overplot it.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} NOTE: Run this cell in the first place}
\PY{c+c1}{\PYZsh{} Load packages for numerical calculations and plotting}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{numpy}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{np}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{plt}
\PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figure.figsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{l+m+mf}{9.6}\PY{p}{,} \PY{l+m+mf}{5.4}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Enable inline plotting in Jupyter notebooks}
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Define the function for pi estimation via Hit\PYZhy{}or\PYZhy{}Miss in the unit square}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{estimate\PYZus{}pi\PYZus{}hit\PYZus{}or\PYZus{}miss}\PY{p}{(}\PY{n}{num\PYZus{}samples}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{42}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Hit\PYZhy{}or\PYZhy{}Miss estimate of pi.}
\PY{l+s+sd}{    Arguments:}
\PY{l+s+sd}{        num\PYZus{}samples (int): Number of random samples to draw.}
\PY{l+s+sd}{        seed (int): Random seed for reproducibility (default: 42).}
\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{        float: Estimated value of pi.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{rng} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{default\PYZus{}rng}\PY{p}{(}\PY{n}{seed}\PY{p}{)}   \PY{c+c1}{\PYZsh{} Create a random number generator with a seed}
    \PY{n}{x} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{num\PYZus{}samples}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Generate uniform random samples in [0, 1)}
    \PY{n}{y} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{num\PYZus{}samples}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} NOTE: EDIT HERE to count points inside the quarter circle}
    \PY{n}{inside\PYZus{}circle} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{count\PYZus{}nonzero}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{x}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{y}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{k}{return} \PY{l+m+mi}{4} \PY{o}{*} \PY{n}{inside\PYZus{}circle} \PY{o}{/} \PY{n}{num\PYZus{}samples}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Define the function for computing the relative error of pi estimation}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{relative\PYZus{}error}\PY{p}{(}\PY{n}{estimate}\PY{p}{,} \PY{n}{true\PYZus{}value}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Compute the relative error of an estimate compared to the true value.}
\PY{l+s+sd}{    Arguments:}
\PY{l+s+sd}{        estimate (float): The estimated value.}
\PY{l+s+sd}{        true\PYZus{}value (float): The true value to compare against (default: np.pi).}
\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{        float: Relative error.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{estimate} \PY{o}{\PYZhy{}} \PY{n}{true\PYZus{}value}\PY{p}{)} \PY{o}{/} \PY{n}{true\PYZus{}value}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Set the random seed}
\PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{2024011182}      \PY{c+c1}{\PYZsh{} NOTE: EDIT HERE to insert your student ID as the seed}

\PY{c+c1}{\PYZsh{} Number of samples to use for pi estimation}
\PY{n}{num\PYZus{}samples} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{500}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{,} \PY{l+m+mi}{5000}\PY{p}{,} \PY{l+m+mi}{10000}\PY{p}{,} \PY{l+m+mi}{50000}\PY{p}{,} \PY{l+m+mi}{100000}\PY{p}{,} \PY{l+m+mi}{500000}\PY{p}{,} \PY{l+m+mi}{1000000}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Compute the pi estimates and their relative errors}
\PY{n}{pi\PYZus{}estimates} \PY{o}{=} \PY{p}{[}\PY{n}{estimate\PYZus{}pi\PYZus{}hit\PYZus{}or\PYZus{}miss}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{seed}\PY{p}{)} \PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n}{num\PYZus{}samples}\PY{p}{]}
\PY{n}{relative\PYZus{}errors} \PY{o}{=} \PY{p}{[}\PY{n}{relative\PYZus{}error}\PY{p}{(}\PY{n}{est}\PY{p}{)} \PY{k}{for} \PY{n}{est} \PY{o+ow}{in} \PY{n}{pi\PYZus{}estimates}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Plot the relative error as a function of number of samples}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{num\PYZus{}samples}\PY{p}{,} \PY{n}{relative\PYZus{}errors}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Samples}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Relative Error of Pi Estimate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} NOTE: EDIT HERE to choose appropriate scales for x and y axes}
\PY{c+c1}{\PYZsh{} Reference: https://matplotlib.org/stable/users/explain/axes/axes\PYZus{}scales.html}
\PY{c+c1}{\PYZsh{} Typical scales: \PYZsq{}linear\PYZsq{} and \PYZsq{}log\PYZsq{}, e.g., plt.xscale(\PYZsq{}log\PYZsq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_6_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Mean relative errors over different seeds}
\PY{n}{seeds} \PY{o}{=} \PY{p}{[}\PY{n}{seed} \PY{o}{+} \PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{]}   \PY{c+c1}{\PYZsh{} Different seeds based on student ID}
\PY{n}{mean\PYZus{}relative\PYZus{}errors} \PY{o}{=} \PY{p}{[}\PY{p}{]}   \PY{c+c1}{\PYZsh{} To store mean relative errors for each num\PYZus{}samples}
\PY{n}{stdev\PYZus{}relative\PYZus{}errors} \PY{o}{=} \PY{p}{[}\PY{p}{]}  \PY{c+c1}{\PYZsh{} To store standard deviation of relative errors}

\PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n}{num\PYZus{}samples}\PY{p}{:}       \PY{c+c1}{\PYZsh{} Loop over different sample sizes}
    \PY{n}{pi\PYZus{}estimates} \PY{o}{=} \PY{p}{[}\PY{n}{estimate\PYZus{}pi\PYZus{}hit\PYZus{}or\PYZus{}miss}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{s}\PY{p}{)} \PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{seeds}\PY{p}{]}
    \PY{n}{relative\PYZus{}errors} \PY{o}{=} \PY{p}{[}\PY{n}{relative\PYZus{}error}\PY{p}{(}\PY{n}{est}\PY{p}{)} \PY{k}{for} \PY{n}{est} \PY{o+ow}{in} \PY{n}{pi\PYZus{}estimates}\PY{p}{]}
    \PY{n}{mean\PYZus{}relative\PYZus{}error} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{relative\PYZus{}errors}\PY{p}{)}
    \PY{n}{stdev\PYZus{}relative\PYZus{}error} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{relative\PYZus{}errors}\PY{p}{)}
    \PY{n}{mean\PYZus{}relative\PYZus{}errors}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean\PYZus{}relative\PYZus{}error}\PY{p}{)}
    \PY{n}{stdev\PYZus{}relative\PYZus{}errors}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{stdev\PYZus{}relative\PYZus{}error}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Plot the mean relative error as a function of number of samples with error bars}
\PY{n}{plt}\PY{o}{.}\PY{n}{errorbar}\PY{p}{(}
    \PY{n}{num\PYZus{}samples}\PY{p}{,}
    \PY{n}{mean\PYZus{}relative\PYZus{}errors}\PY{p}{,}
    \PY{n}{yerr} \PY{o}{=} \PY{n}{stdev\PYZus{}relative\PYZus{}errors}\PY{p}{,}
    \PY{n}{fmt} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{ls} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{capsize} \PY{o}{=} \PY{l+m+mi}{5}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Samples}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean Relative Error of Pi Estimate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} NOTE: EDIT HERE to choose appropriate scales for x and y axes}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_7_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{7}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Guess the error scaling relationship and overplot it}
\PY{n}{scaling\PYZus{}x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}  \PY{c+c1}{\PYZsh{} x values for the scaling line}
\PY{n}{scaling\PYZus{}y} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{scaling\PYZus{}x}\PY{p}{)}    \PY{c+c1}{\PYZsh{} NOTE: EDIT HERE to define the scaling relationship, e.g., 1/scaling\PYZus{}x}

\PY{n}{plt}\PY{o}{.}\PY{n}{errorbar}\PY{p}{(}
    \PY{n}{num\PYZus{}samples}\PY{p}{,}
    \PY{n}{mean\PYZus{}relative\PYZus{}errors}\PY{p}{,}
    \PY{n}{yerr} \PY{o}{=} \PY{n}{stdev\PYZus{}relative\PYZus{}errors}\PY{p}{,}
    \PY{n}{fmt} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{ls} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{capsize} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean Relative Error}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
    \PY{n}{scaling\PYZus{}x}\PY{p}{,}
    \PY{n}{scaling\PYZus{}y}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Scaling Relationship}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{linestyle} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Samples}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean Relative Error of Pi Estimate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} NOTE: EDIT HERE to choose appropriate scales for x and y axes}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_8_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{Question 1.2: Sample mean
method}\label{question-1.2-sample-mean-method}

The Monte-Carlo \textbf{sample mean} method estimates a definite
integral by generating random samples from a uniform distribution over
the integration domain, evaluating the function at those points, and
then calculating the average of these function values. This average is
then multiplied by the volume of the integration domain to estimate the
integral.

\textbf{Idea:} Re-estimate \(\pi\), but now using the sample mean method
with the integral

\[
\pi = 4 \int_0^1 \sqrt{1 - x^2} \, {\rm d}x
\]

\textbf{Tasks:} 1. Write a function to estimate the value of \(\pi\)
using the sample mean method. 2. On the same \(N\) grid as in Question
1.1, plot the mean relative \(\pi\) error over 10 different random seeds
for both estimators. Overplot the guessed scaling relations. 3. Discuss
the results and compare the two methods.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Define the function for pi estimation via the sample mean method}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{estimate\PYZus{}pi\PYZus{}sample\PYZus{}mean}\PY{p}{(}\PY{n}{num\PYZus{}samples}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{42}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Sample Mean estimate of pi.}
\PY{l+s+sd}{    Arguments:}
\PY{l+s+sd}{        num\PYZus{}samples (int): Number of random samples to draw.}
\PY{l+s+sd}{        seed (int): Random seed for reproducibility (default: 42).}
\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{        float: Estimated value of pi.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{rng} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{default\PYZus{}rng}\PY{p}{(}\PY{n}{seed}\PY{p}{)}   \PY{c+c1}{\PYZsh{} Create a random number generator with a seed}
    \PY{n}{x} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{num\PYZus{}samples}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Generate uniform random samples in [0, 1)}
    \PY{c+c1}{\PYZsh{} NOTE: EDIT HERE to estimate pi using the sample mean method}
    \PY{n}{f\PYZus{}x} \PY{o}{=} \PY{l+m+mi}{4} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{x}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{pi} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{f\PYZus{}x} \PY{o}{*} \PY{l+m+mi}{1}\PY{o}{/}\PY{n}{num\PYZus{}samples}\PY{p}{)}
    \PY{k}{return} \PY{n}{pi}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{9}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Compute the relative errors for the sample mean method}
\PY{n}{mean\PYZus{}relative\PYZus{}errors\PYZus{}sample\PYZus{}mean} \PY{o}{=} \PY{p}{[}\PY{p}{]}   \PY{c+c1}{\PYZsh{} To store mean relative errors for each num\PYZus{}samples}
\PY{n}{stdev\PYZus{}relative\PYZus{}errors\PYZus{}sample\PYZus{}mean} \PY{o}{=} \PY{p}{[}\PY{p}{]}  \PY{c+c1}{\PYZsh{} To store standard deviation of relative errors}

\PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n}{num\PYZus{}samples}\PY{p}{:}       \PY{c+c1}{\PYZsh{} Loop over different sample sizes}
    \PY{n}{pi\PYZus{}estimates} \PY{o}{=} \PY{p}{[}\PY{n}{estimate\PYZus{}pi\PYZus{}sample\PYZus{}mean}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{s}\PY{p}{)} \PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{seeds}\PY{p}{]}
    \PY{n}{relative\PYZus{}errors} \PY{o}{=} \PY{p}{[}\PY{n}{relative\PYZus{}error}\PY{p}{(}\PY{n}{est}\PY{p}{)} \PY{k}{for} \PY{n}{est} \PY{o+ow}{in} \PY{n}{pi\PYZus{}estimates}\PY{p}{]}
    \PY{n}{mean\PYZus{}relative\PYZus{}error} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{relative\PYZus{}errors}\PY{p}{)}
    \PY{n}{stdev\PYZus{}relative\PYZus{}error} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{relative\PYZus{}errors}\PY{p}{)}
    \PY{n}{mean\PYZus{}relative\PYZus{}errors\PYZus{}sample\PYZus{}mean}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean\PYZus{}relative\PYZus{}error}\PY{p}{)}
    \PY{n}{stdev\PYZus{}relative\PYZus{}errors\PYZus{}sample\PYZus{}mean}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{stdev\PYZus{}relative\PYZus{}error}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Plot the mean relative errors with error bars for both methods}
\PY{n}{plt}\PY{o}{.}\PY{n}{errorbar}\PY{p}{(}
    \PY{n}{num\PYZus{}samples}\PY{p}{,}
    \PY{n}{mean\PYZus{}relative\PYZus{}errors\PYZus{}sample\PYZus{}mean}\PY{p}{,}
    \PY{n}{yerr} \PY{o}{=} \PY{n}{stdev\PYZus{}relative\PYZus{}errors\PYZus{}sample\PYZus{}mean}\PY{p}{,}
    \PY{n}{fmt} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{ls} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{capsize} \PY{o}{=} \PY{l+m+mi}{5}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{errorbar}\PY{p}{(}
    \PY{n}{num\PYZus{}samples}\PY{p}{,}
    \PY{n}{mean\PYZus{}relative\PYZus{}errors}\PY{p}{,}
    \PY{n}{yerr} \PY{o}{=} \PY{n}{stdev\PYZus{}relative\PYZus{}errors}\PY{p}{,}
    \PY{n}{fmt} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{ls} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{capsize} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean Relative Error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Samples}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M\PYZhy{}C Sample Mean Error of Pi Estimate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_11_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Guess the error scaling relationships and overplot them}
\PY{c+c1}{\PYZsh{} NOTE: EDIT HERE to define the scaling relationship for sample mean method}
\PY{n}{scaling\PYZus{}y\PYZus{}sample\PYZus{}mean} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{n}{scaling\PYZus{}x}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{l+m+mi}{5}\PY{o}{/}\PY{l+m+mi}{8}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Plot the mean relative errors for both methods with guessed scalings}
\PY{n}{plt}\PY{o}{.}\PY{n}{errorbar}\PY{p}{(}
    \PY{n}{num\PYZus{}samples}\PY{p}{,}
    \PY{n}{mean\PYZus{}relative\PYZus{}errors\PYZus{}sample\PYZus{}mean}\PY{p}{,}
    \PY{n}{yerr} \PY{o}{=} \PY{n}{stdev\PYZus{}relative\PYZus{}errors\PYZus{}sample\PYZus{}mean}\PY{p}{,}
    \PY{n}{fmt} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{ls} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{capsize} \PY{o}{=} \PY{l+m+mi}{5}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{errorbar}\PY{p}{(}
    \PY{n}{num\PYZus{}samples}\PY{p}{,}
    \PY{n}{mean\PYZus{}relative\PYZus{}errors}\PY{p}{,}
    \PY{n}{yerr} \PY{o}{=} \PY{n}{stdev\PYZus{}relative\PYZus{}errors}\PY{p}{,}
    \PY{n}{fmt} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{ls} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{capsize} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean Relative Error}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
    \PY{n}{scaling\PYZus{}x}\PY{p}{,}
    \PY{n}{scaling\PYZus{}y\PYZus{}sample\PYZus{}mean}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Scaling Relationship}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{linestyle} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Samples}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M\PYZhy{}C Sample Mean Error of Pi Estimate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_12_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subparagraph{Discussions}\label{discussions}

Compared with the first method estimating \(\pi\), the second method has
less error, and the error function falls off more rapidly with the
increase of number of samples. So maybe the second method is better.

    \subsubsection{\texorpdfstring{Exercise 2: Monte-Carlo \(\pi\)
estimation with
mask}{Exercise 2: Monte-Carlo \textbackslash pi estimation with mask}}\label{exercise-2-monte-carlo-pi-estimation-with-mask}

\paragraph{Question 2.1: ``Hit-or-Miss'' method with
mask}\label{question-2.1-hit-or-miss-method-with-mask}

\textbf{Idea:} Suppose we cannot sample the entire unit square (e.g.,
due to CCD gaps) and there is a vertical mask with width 0.2.

\textbf{Tasks:} 1. Modify the ``Hit-or-Miss'' function to account for a
vertical mask with a forbidden region
\(x \in [0.6, 0.8), y \in [0, 1)\). 2. Suppose we do not know the exact
position of the mask, but we know its width (0.2), what is the best
strategy to estimate \(\pi\)? Implement it and plot the mean relative
error as a function of \(N\) with the same \(N\) grid as in Question
1.1.

\textbf{Hint:} Since the position of the mask is unknown, you cannot
estimate the area of the masked region directly. Instead, you can use a
statistical approach.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Define the function for pi estimation via Hit\PYZhy{}or\PYZhy{}Miss with a vertical mask}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{estimate\PYZus{}pi\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}with\PYZus{}mask}\PY{p}{(}\PY{n}{num\PYZus{}samples}\PY{p}{,} \PY{n}{mask\PYZus{}start} \PY{o}{=} \PY{l+m+mf}{0.6}\PY{p}{,} \PY{n}{mask\PYZus{}end} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{42}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Hit\PYZhy{}or\PYZhy{}Miss estimate of pi with a vertical mask.}
\PY{l+s+sd}{    Arguments:}
\PY{l+s+sd}{        num\PYZus{}samples (int): Number of random samples to draw.}
\PY{l+s+sd}{        mask\PYZus{}start (float): Start of the mask in x (default: 0.6).}
\PY{l+s+sd}{        mask\PYZus{}end (float): End of the mask in x (default: 0.8).}
\PY{l+s+sd}{        seed (int): Random seed for reproducibility (default: 42).}
\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{        float: Estimated value of pi.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{rng} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{default\PYZus{}rng}\PY{p}{(}\PY{n}{seed}\PY{p}{)}   \PY{c+c1}{\PYZsh{} Create a random number generator with a seed}
    \PY{n}{x} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{num\PYZus{}samples}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Generate uniform random samples in [0, 1)}
    \PY{n}{y} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{num\PYZus{}samples}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Apply the mask: filter out points that fall within the masked region}
    \PY{n}{valid\PYZus{}indices} \PY{o}{=} \PY{p}{(}\PY{n}{x} \PY{o}{\PYZlt{}} \PY{n}{mask\PYZus{}start}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{x} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{mask\PYZus{}end}\PY{p}{)}
    \PY{n}{x\PYZus{}valid} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{n}{valid\PYZus{}indices}\PY{p}{]}
    \PY{n}{y\PYZus{}valid} \PY{o}{=} \PY{n}{y}\PY{p}{[}\PY{n}{valid\PYZus{}indices}\PY{p}{]}

    \PY{c+c1}{\PYZsh{} NOTE: EDIT HERE to estimate pi using the valid points only}
    \PY{c+c1}{\PYZsh{} estimate pi}
    \PY{n}{inside\PYZus{}circle\PYZus{}valid} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{count\PYZus{}nonzero}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{x\PYZus{}valid}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{y\PYZus{}valid}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{l+m+mi}{1}\PY{p}{)}
    
    \PY{k}{return} \PY{l+m+mi}{4} \PY{o}{*} \PY{p}{(}\PY{n}{inside\PYZus{}circle\PYZus{}valid} \PY{o}{/} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}valid}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{12}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Compute the relative errors for the masked Hit\PYZhy{}or\PYZhy{}Miss method with different numbers of samples}

\PY{n}{mean\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}with\PYZus{}mask} \PY{o}{=} \PY{p}{[}\PY{p}{]}   \PY{c+c1}{\PYZsh{} To store mean relative errors for each num\PYZus{}samples}
\PY{n}{stdev\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}with\PYZus{}mask} \PY{o}{=} \PY{p}{[}\PY{p}{]}  \PY{c+c1}{\PYZsh{} To store standard deviation of relative errors}

\PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n}{num\PYZus{}samples}\PY{p}{:}       \PY{c+c1}{\PYZsh{} Loop over different sample sizes}
    \PY{n}{pi\PYZus{}estimates} \PY{o}{=} \PY{p}{[}\PY{n}{estimate\PYZus{}pi\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}with\PYZus{}mask}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{mask\PYZus{}start} \PY{o}{=} \PY{l+m+mf}{0.6}\PY{p}{,} \PY{n}{mask\PYZus{}end} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{n}{s}\PY{p}{)} \PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{seeds}\PY{p}{]}
    \PY{n}{relative\PYZus{}errors} \PY{o}{=} \PY{p}{[}\PY{n}{relative\PYZus{}error}\PY{p}{(}\PY{n}{est}\PY{p}{)} \PY{k}{for} \PY{n}{est} \PY{o+ow}{in} \PY{n}{pi\PYZus{}estimates}\PY{p}{]}
    \PY{n}{mean\PYZus{}relative\PYZus{}error} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{relative\PYZus{}errors}\PY{p}{)}
    \PY{n}{stdev\PYZus{}relative\PYZus{}error} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{relative\PYZus{}errors}\PY{p}{)}
    \PY{n}{mean\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}with\PYZus{}mask}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean\PYZus{}relative\PYZus{}error}\PY{p}{)}
    \PY{n}{stdev\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}with\PYZus{}mask}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{stdev\PYZus{}relative\PYZus{}error}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Plot the mean relative errors with error bars for both methods}
\PY{n}{plt}\PY{o}{.}\PY{n}{errorbar}\PY{p}{(}
    \PY{n}{num\PYZus{}samples}\PY{p}{,}
    \PY{n}{mean\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}with\PYZus{}mask}\PY{p}{,}
    \PY{n}{yerr} \PY{o}{=} \PY{n}{stdev\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}with\PYZus{}mask}\PY{p}{,}
    \PY{n}{fmt} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{ls} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{capsize} \PY{o}{=} \PY{l+m+mi}{5}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{errorbar}\PY{p}{(}
    \PY{n}{num\PYZus{}samples}\PY{p}{,}
    \PY{n}{mean\PYZus{}relative\PYZus{}errors\PYZus{}sample\PYZus{}mean}\PY{p}{,}
    \PY{n}{yerr} \PY{o}{=} \PY{n}{stdev\PYZus{}relative\PYZus{}errors\PYZus{}sample\PYZus{}mean}\PY{p}{,}
    \PY{n}{fmt} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{ls} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{capsize} \PY{o}{=} \PY{l+m+mi}{5}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Samples}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{H or M with Mask Error of Pi Estimate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_16_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{Question 2.2: Uncertainty
estimation}\label{question-2.2-uncertainty-estimation}

\textbf{Idea:} The true mask position is \(x \in [0.6, 0.8)\) but it is
unknown. Our information is incomplete due to the mask. We need to
report an uncertainty estimate along with our \(\pi\) estimate.

\textbf{Tasks:} 1. Estimate the uncertainty of \(\pi\) estimate by
assuming the center of mask is uniformly distributed in \([0.1, 0.9)\).
2. Plot the mean relative error and the uncertainty as a function of
\(N\) with the same \(N\) grid as in Question 1.1. 3. Discuss the
results.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Report an uncertainty estimate along with your pi estimate}

\PY{k}{def}\PY{+w}{ }\PY{n+nf}{relative\PYZus{}error\PYZus{}with\PYZus{}mask}\PY{p}{(}\PY{n}{num\PYZus{}samples}\PY{p}{,} \PY{n}{num\PYZus{}trials} \PY{o}{=} \PY{l+m+mi}{100}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Calculate mean relative error and uncertainty for pi estimation with random mask positions.}
\PY{l+s+sd}{    }
\PY{l+s+sd}{    Arguments:}
\PY{l+s+sd}{        num\PYZus{}samples (list): List of different sample sizes to test.}
\PY{l+s+sd}{        num\PYZus{}trials (int): Number of trials for each sample size to estimate uncertainty.}
\PY{l+s+sd}{    }
\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{        tuple: (mean\PYZus{}relative\PYZus{}errors, uncertainties)}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{mean\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}with\PYZus{}mask} \PY{o}{=} \PY{p}{[}\PY{p}{]}   \PY{c+c1}{\PYZsh{} To store mean relative errors for each num\PYZus{}samples}
    \PY{n}{uncertainties} \PY{o}{=} \PY{p}{[}\PY{p}{]}          \PY{c+c1}{\PYZsh{} To store uncertainty estimates for each num\PYZus{}samples}

    \PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n}{num\PYZus{}samples}\PY{p}{:}       \PY{c+c1}{\PYZsh{} Loop over different sample sizes}
        \PY{n}{relative\PYZus{}errors} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        
        \PY{k}{for} \PY{n}{trial} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}trials}\PY{p}{)}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} Randomly select mask center uniformly from [0.1, 0.9)}
            \PY{n}{mask\PYZus{}center} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.9}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{} Use trial number as seed for reproducibility}
            \PY{n}{pi\PYZus{}estimate} \PY{o}{=} \PY{n}{estimate\PYZus{}pi\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}with\PYZus{}mask}\PY{p}{(}
                \PY{n}{n}\PY{p}{,} \PY{n}{mask\PYZus{}start} \PY{o}{=} \PY{n}{mask\PYZus{}center} \PY{o}{\PYZhy{}} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{mask\PYZus{}end} \PY{o}{=} \PY{n}{mask\PYZus{}center} \PY{o}{+} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{n}{trial}
            \PY{p}{)}
            \PY{n}{relative\PYZus{}errors}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{relative\PYZus{}error}\PY{p}{(}\PY{n}{pi\PYZus{}estimate}\PY{p}{)}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Calculate mean and uncertainty (standard deviation of the mean)}
        \PY{n}{mean\PYZus{}relative\PYZus{}error} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{relative\PYZus{}errors}\PY{p}{)}
        \PY{n}{uncertainty} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{relative\PYZus{}errors}\PY{p}{)} \PY{o}{/} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{num\PYZus{}trials}\PY{p}{)}  \PY{c+c1}{\PYZsh{} uncertainty of uniform distribution}
        
        \PY{n}{mean\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}with\PYZus{}mask}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean\PYZus{}relative\PYZus{}error}\PY{p}{)}
        \PY{n}{uncertainties}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{uncertainty}\PY{p}{)}
    
    \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{mean\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}with\PYZus{}mask}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{uncertainties}\PY{p}{)}

\PY{n}{mean\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}with\PYZus{}mask}\PY{p}{,} \PY{n}{uncertainties} \PY{o}{=} \PY{n}{relative\PYZus{}error\PYZus{}with\PYZus{}mask}\PY{p}{(}\PY{n}{num\PYZus{}samples}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{errorbar}\PY{p}{(}
    \PY{n}{num\PYZus{}samples}\PY{p}{,}
    \PY{n}{mean\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}with\PYZus{}mask}\PY{p}{,}
    \PY{n}{yerr} \PY{o}{=} \PY{n}{uncertainties}\PY{p}{,}
    \PY{n}{fmt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{o}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{n}{ls} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZhy{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{n}{capsize} \PY{o}{=} \PY{l+m+mi}{5}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Samples}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean Relative Errors of Pi Estimate with Mask}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_18_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subparagraph{Discussions}\label{discussions}

If we do not know how the mask distributes, our estimate is incomplete.
But we can guess the probable distribution function of mask, and
calculate the uncertainties of each \(N\), in order to cover the true
value of \(\pi\).

    \subsubsection{Exercise 3: Logistic map as a ``random''
source}\label{exercise-3-logistic-map-as-a-random-source}

The \href{https://en.wikipedia.org/wiki/Logistic_map}{\textbf{Logistic
map}} is a recurrence polynomial mapping:

\[
x_{n+1} = r x_n (1 - x_n)
\]

where \(r\) is a parameter (typically in the range \([0, 4]\)) and
\(x_n\) is a number between 0 and 1. The logistic map is a classic
example of how deterministic systems can exhibit chaotic behaviour for
certain values of \(r\).

With the transformation

\[
u_n = \frac{2}{\pi} \arcsin(\sqrt{x_n})
\]

the logistic map with \(r=4\) can be shown to have a uniform invariant
distribution in \((0, 1)\).

\textbf{Idea:} Show that ``randomness'' required by Monte-Carlo methods
does not necessarily mean ``unpredictability''. A deterministic chaotic
system can also be used as a pseudo-random number generator.

\textbf{Tasks:} 1. Define \(x_{n+1} = 4 x_n (1 - x_n)\) with \(x_0\)
from a fixed seed in \((0, 1)\). Use the sequence \(\{u_n\}\) as
``uniform randoms'' in \((0,1)\), where
\(u_n = 2 \arcsin(\sqrt{x_n}) / \pi\). 2. For each \(N\) in
\(\{10^2, 10^3, 10^4, 10^5\}\), plot the histogram of the first \(N\)
values of the logistic map and compare it with the uniform distribution.
3. Use the logistic map to estimate \(\pi\) using the ``Hit-or-Miss''
method. Plot the relative errors together with that using
\texttt{numpy}'s random number generator as a function of \(N\). 4.
Discuss the results.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{14}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} \PYZdq{}Random\PYZdq{} number generator with logistic map}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{logistic\PYZus{}map\PYZus{}sequence}\PY{p}{(}\PY{n}{N}\PY{p}{,} \PY{n}{x0}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{r}\PY{o}{=}\PY{l+m+mf}{4.0}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Generate a sequence of pseudo\PYZhy{}random numbers using the logistic map.}
\PY{l+s+sd}{    Arguments:}
\PY{l+s+sd}{        N (int): Number of random numbers to generate.}
\PY{l+s+sd}{        x0 (float): Initial value (default: 0.5).}
\PY{l+s+sd}{        r (float): Parameter for the logistic map (default: 4.0).}
\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{        np.ndarray: Array of pseudo\PYZhy{}random numbers in (0,1).}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{x} \PY{o}{=} \PY{n}{x0}
    \PY{n}{seq} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{k}{for} \PY{n}{\PYZus{}} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{N}\PY{p}{)}\PY{p}{:}
        \PY{n}{x} \PY{o}{=} \PY{n}{r} \PY{o}{*} \PY{n}{x} \PY{o}{*} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{x}\PY{p}{)}
        \PY{n}{u} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{2} \PY{o}{/} \PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{)} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{arcsin}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{)}
        \PY{n}{seq}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{u}\PY{p}{)}
    \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{seq}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{15}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{x0} \PY{o}{=} \PY{p}{(}\PY{n}{seed} \PY{o}{\PYZpc{}} \PY{l+m+mi}{1000} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{/} \PY{l+m+mf}{1001.0}     \PY{c+c1}{\PYZsh{} Initial value based on student ID}

\PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n}{num\PYZus{}samples}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{figure}
    \PY{n}{u} \PY{o}{=} \PY{n}{logistic\PYZus{}map\PYZus{}sequence}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{x0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{hist}\PY{p}{(}
        \PY{n}{u}\PY{p}{,}
        \PY{n}{density} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,}
        \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.6}\PY{p}{,}
        \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Histogram of Logistic Sequence}\PY{l+s+s1}{\PYZsq{}}
    \PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{u\PYZus{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Density of u\PYZus{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_22_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_22_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_22_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_22_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_22_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_22_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_22_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_22_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_22_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_22_9.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_22_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Use Hit or Miss Method to estimate Pi}

\PY{k}{def}\PY{+w}{ }\PY{n+nf}{estimate\PYZus{}pi\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}logistic}\PY{p}{(}\PY{n}{num\PYZus{}samples}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{42}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Hit\PYZhy{}or\PYZhy{}Miss estimate of pi with random numbers generated from logistic sequence.}
\PY{l+s+sd}{    Arguments:}
\PY{l+s+sd}{        num\PYZus{}samples (int): Number of random samples to draw.}
\PY{l+s+sd}{        x0 (int): the first number of logistic sequence.}
\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{        float: Estimated value of pi.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{x0} \PY{o}{=} \PY{p}{(}\PY{n}{seed} \PY{o}{\PYZpc{}} \PY{l+m+mi}{1000} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{/} \PY{l+m+mf}{1001.0}
    \PY{c+c1}{\PYZsh{} make a y0 different from x0}
    \PY{n}{y0} \PY{o}{=} \PY{n}{x0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3}
    
    \PY{n}{x} \PY{o}{=} \PY{n}{logistic\PYZus{}map\PYZus{}sequence}\PY{p}{(}\PY{n}{num\PYZus{}samples}\PY{p}{,} \PY{n}{x0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}
    \PY{n}{y} \PY{o}{=} \PY{n}{logistic\PYZus{}map\PYZus{}sequence}\PY{p}{(}\PY{n}{num\PYZus{}samples}\PY{p}{,} \PY{n}{y0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}
    \PY{n}{inside\PYZus{}circle} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{count\PYZus{}nonzero}\PY{p}{(}\PY{n}{x}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{y}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZlt{}} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{k}{return} \PY{l+m+mi}{4} \PY{o}{*} \PY{n}{inside\PYZus{}circle} \PY{o}{/} \PY{n}{num\PYZus{}samples}

\PY{c+c1}{\PYZsh{} Compute the relative errors}
\PY{n}{mean\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}logistic} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{stdev\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}logistic} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n}{num\PYZus{}samples}\PY{p}{:}       \PY{c+c1}{\PYZsh{} Loop over different sample sizes}
    \PY{n}{pi\PYZus{}estimates} \PY{o}{=} \PY{p}{[}\PY{n}{estimate\PYZus{}pi\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}logistic}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{s}\PY{p}{)} \PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{seeds}\PY{p}{]}
    \PY{n}{relative\PYZus{}errors} \PY{o}{=} \PY{p}{[}\PY{n}{relative\PYZus{}error}\PY{p}{(}\PY{n}{est}\PY{p}{)} \PY{k}{for} \PY{n}{est} \PY{o+ow}{in} \PY{n}{pi\PYZus{}estimates}\PY{p}{]}
    \PY{n}{mean\PYZus{}relative\PYZus{}error} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{relative\PYZus{}errors}\PY{p}{)}
    \PY{n}{stdev\PYZus{}relative\PYZus{}error} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{relative\PYZus{}errors}\PY{p}{)}
    \PY{n}{mean\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}logistic}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean\PYZus{}relative\PYZus{}error}\PY{p}{)}
    \PY{n}{stdev\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}logistic}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{stdev\PYZus{}relative\PYZus{}error}\PY{p}{)}
    
\PY{n}{plt}\PY{o}{.}\PY{n}{errorbar}\PY{p}{(}
    \PY{n}{num\PYZus{}samples}\PY{p}{,}
    \PY{n}{mean\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}logistic}\PY{p}{,}
    \PY{n}{yerr} \PY{o}{=} \PY{n}{stdev\PYZus{}relative\PYZus{}errors\PYZus{}hit\PYZus{}or\PYZus{}miss\PYZus{}logistic}\PY{p}{,}
    \PY{n}{fmt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{o}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{n}{ls} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{capsize} \PY{o}{=} \PY{l+m+mi}{5}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{errorbar}\PY{p}{(}
    \PY{n}{num\PYZus{}samples}\PY{p}{,}
    \PY{n}{mean\PYZus{}relative\PYZus{}errors}\PY{p}{,}
    \PY{n}{yerr} \PY{o}{=} \PY{n}{stdev\PYZus{}relative\PYZus{}errors}\PY{p}{,}
    \PY{n}{fmt} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{ls} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{capsize} \PY{o}{=} \PY{l+m+mi}{5}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_01_files/Exercise_week_01_23_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subparagraph{Discussions}\label{discussions}

用 logistic 映射作为随机数的生成器比直接调用 \texttt{np.random}
函数得到的结果要好，这可能是因为 logistic
映射产生的随机数分布更加接近估算 \(\pi\) 值所需要的分布.

具体而言，我们在让 logistic 映射变成均匀分布时使用了变换
\(u_n = 2/\pi\cdot\arcsin(\sqrt{x_n})\)，这里已经用到了 \(\pi\)
的真实值，那么无形中可能优化了这个估算 \(\pi\) 的算法；另外，logistic
映射本身是可以遍历 \((0,1)\) 的整个区间的，而 \texttt{np.random}
函数有很长的周期 \(2^{19937} - 1\) (而不是遍历 \((0,1)\)
的所有可能值)，或许这造成了两者效果的差异.

    \subsubsection{Note: steps for submitting the
exercise}\label{note-steps-for-submitting-the-exercise}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  In the menu bar, select \texttt{File\ \textgreater{}\ Download} to
  download your notebook as a \texttt{.ipynb} file.
\item
  Select
  \texttt{File\ \textgreater{}\ Save\ and\ Export\ Notebook\ As\ \textgreater{}\ PDF}
  to export your notebook as a PDF file.
\item
  Combine the \texttt{.ipynb} and \texttt{.pdf} files into a single
  \texttt{.zip} or \texttt{.tar.gz} archive.
\item
  Upload your archive to the web learning platform (网络学堂).
\end{enumerate}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
