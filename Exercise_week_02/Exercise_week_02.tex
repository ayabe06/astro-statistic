\documentclass[11pt]{article}
    \author{刘乐融}
    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    \usepackage{ctex}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Keep aspect ratio if custom image width or height is specified
    \setkeys{Gin}{keepaspectratio}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro

    \usepackage{iftex}
    \ifPDFTeX
        \usepackage[T1]{fontenc}
        \IfFileExists{alphabeta.sty}{
              \usepackage{alphabeta}
          }{
              \usepackage[mathletters]{ucs}
              \usepackage[utf8x]{inputenc}
          }
    \else
        \usepackage{fontspec}
        \usepackage{unicode-math}
    \fi

    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage{array}     % table support for pandoc >= 2.11.3
    \usepackage{calc}      % table minipage width calculation for pandoc >= 2.11.1
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{soul}      % strikethrough (\st) support for pandoc >= 3.0.0
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}

    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \makeatletter
    \newsavebox\pandoc@box
    \newcommand*\pandocbounded[1]{%
      \sbox\pandoc@box{#1}%
      % scaling factors for width and height
      \Gscale@div\@tempa\textheight{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
      \Gscale@div\@tempb\linewidth{\wd\pandoc@box}%
      % select the smaller of both
      \ifdim\@tempb\p@<\@tempa\p@
        \let\@tempa\@tempb
      \fi
      % scaling accordingly (\@tempa < 1)
      \ifdim\@tempa\p@<\p@
        \scalebox{\@tempa}{\usebox\pandoc@box}%
      % scaling not needed, use as it is
      \else
        \usebox{\pandoc@box}%
      \fi
    }
    \makeatother

    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{Exercise\_week\_02}
    
    
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.61,0.40,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.80,0.25,0.22}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.46,0.46,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.41,0.47,0.13}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.36,0.12}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.52,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{0.89,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@ges}{\let\PY@bf=\textbf\let\PY@it=\textit}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb.
    \makeatletter
        \newbox\Wrappedcontinuationbox
        \newbox\Wrappedvisiblespacebox
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}}
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}}
        \newcommand*\Wrappedcontinuationindent {3ex }
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox}
        % Take advantage of the already applied Pygments mark-up to insert
        % potential linebreaks for TeX processing.
        %        {, <, #, %, $, ' and ": go to next line.
        %        _, }, ^, &, >, - and ~: stay at end of broken line.
        % Use of \textquotesingle for straight quote.
        \newcommand*\Wrappedbreaksatspecials {%
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}%
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}%
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}%
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}%
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}%
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}%
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}%
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}%
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}%
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}%
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}%
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}%
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}%
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}%
        }
        % Some characters . , ; ? ! / are not pygmentized.
        % This macro makes them "active" and they will insert potential linebreaks
        \newcommand*\Wrappedbreaksatpunct {%
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}%
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}%
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}%
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}%
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}%
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}%
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}%
            \catcode`\.\active
            \catcode`\,\active
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active
            \lccode`\~`\~
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%

        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}

    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \section{Statistical Methods in Astrophysics
Exercises}\label{statistical-methods-in-astrophysics-exercises}

\subsection{Week 01: Probability
Theory}\label{week-01-probability-theory}

\subsubsection{Personal Information}\label{personal-information}

\textbf{Name:} 刘乐融

\textbf{Student ID:} 2024011182

    \subsubsection{Exercise 1: Flood risk
simulation}\label{exercise-1-flood-risk-simulation}

A dam is built in a region where days are sunny or rainy, each with a
long-term stable probability of 0.5. A flood occurs if there are at
least 7 consecutive rainy days in a row; a long run of rainy days is
counted only once.

\paragraph{Question 1.1: A plain Monte-Carlo
simulation}\label{question-1.1-a-plain-monte-carlo-simulation}

\textbf{Task:} Simulate 10,000 years of weather data with independent
and identically distributed probabilities of sunny and rainy days.
Estimate the expected number of floods per 365-day year.

\textbf{Hint:} You may generate binary random numbers to represent sunny
and rainy days, e.g., 0 for sunny and 1 for rainy.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} NOTE: Run this cell in the first place}
\PY{c+c1}{\PYZsh{} Load packages for numerical calculations and plotting}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{numpy}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{np}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{plt}
\PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figure.figsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{l+m+mf}{9.6}\PY{p}{,} \PY{l+m+mf}{5.4}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Enable inline plotting in Jupyter notebooks}
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} A helper function to return the lengths of consecutive runs of 1s in a binary array}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{consecutive\PYZus{}ones}\PY{p}{(}\PY{n}{arr}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Return the lengths of consecutive 1s in a binary array.\PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{c+c1}{\PYZsh{} Identify the start and end indices of sequences of 1s}
    \PY{n}{changes} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{n}{arr}\PY{p}{,} \PY{n}{prepend} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{append} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}
    \PY{n}{start\PYZus{}indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{changes} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
    \PY{n}{end\PYZus{}indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{changes} \PY{o}{==} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
    \PY{c+c1}{\PYZsh{} Calculate the lengths of these sequences}
    \PY{n}{lengths} \PY{o}{=} \PY{n}{end\PYZus{}indices} \PY{o}{\PYZhy{}} \PY{n}{start\PYZus{}indices}
    \PY{k}{return} \PY{n}{lengths}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Set the random seed}
\PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{2024011182} \PY{c+c1}{\PYZsh{} NOTE: EDIT HERE to insert your student ID as the seed}
\PY{n}{nsample} \PY{o}{=} \PY{l+m+mi}{365} \PY{o}{*} \PY{l+m+mi}{10000} \PY{c+c1}{\PYZsh{} number of days to simulate}

\PY{n}{rng} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{default\PYZus{}rng}\PY{p}{(}\PY{n}{seed}\PY{p}{)}
\PY{n}{weather} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{integers}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{size} \PY{o}{=} \PY{n}{nsample}\PY{p}{)} \PY{c+c1}{\PYZsh{} 0 for sunny, 1 for rainy}

\PY{c+c1}{\PYZsh{} Validate the overall fraction of rainy days}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fraction of rainy days: }\PY{l+s+si}{\PYZob{}}\PY{n}{weather}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{l+s+si}{:}\PY{l+s+s1}{.4\PYZpc{}}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Fraction of rainy days: 49.9785\%
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Get the lengths of consecutive rainy days}
\PY{n}{rainy\PYZus{}lengths} \PY{o}{=} \PY{n}{consecutive\PYZus{}ones}\PY{p}{(}\PY{n}{weather}\PY{p}{)}

\PY{c+c1}{\PYZsh{} NOTE: EDIT BELOW to compute the expected number of floods per year}
\PY{n}{flood\PYZus{}events} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{consecutive\PYZus{}ones}\PY{p}{(}\PY{n}{weather}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mi}{7}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{flood\PYZus{}events}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{n}{nsample} \PY{o}{/} \PY{l+m+mi}{365}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
1.4178
    \end{Verbatim}

    \paragraph{Question 1.2: Markov-chain Monte-Carlo (MCMC)
simulation}\label{question-1.2-markov-chain-monte-carlo-mcmc-simulation}

In reality, weather conditions are correlated in time. For example, a
rainy day is more likely to be followed by another rainy day. We can
model the weather as a two-state Markov chain with the following
transition matrix:

\[
T = 
\begin{bmatrix}
P(S \to S) & P(S \to R) \\
P(R \to S) & P(R \to R)
\end{bmatrix}
\]

where \(S\) and \(R\) denote sunny and rainy days, respectively.
\(P(S \to S)\) is the probability of a sunny day being followed by
another sunny day, and so on.

Assume that \(P(S \to S) = P(R \to R) = 0.7\).

\textbf{Tasks:} 1. Complete the transition matrix and implement a Markov
chain simulation to generate weather data in 100 years. Estimate the
expected number of floods per 365-day year. 2. Plot the histogram of the
lengths of consecutive rainy days obtained from both simulations in
Questions 1.1 and 1.2. Choose appropriate bin sizes, ranges, and axes
scales to clearly show the differences between the two distributions. 3.
Comment on the differences between the two distributions.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{7}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{markov\PYZus{}chain\PYZus{}simulation}\PY{p}{(}\PY{n}{transition\PYZus{}matrix}\PY{p}{,} \PY{n}{n\PYZus{}steps}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{42}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Markov\PYZhy{}chain Monte\PYZhy{}Carlo simulation of weather data.}
\PY{l+s+sd}{    Args:}
\PY{l+s+sd}{        transition\PYZus{}matrix (2x2 array): transition probabilities.}
\PY{l+s+sd}{        n\PYZus{}steps (int): Number of steps to simulate.}
\PY{l+s+sd}{        seed (int): Random seed for reproducibility.}
\PY{l+s+sd}{    Returns: weather sequence}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{rng} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{default\PYZus{}rng}\PY{p}{(}\PY{n}{seed}\PY{p}{)}
    \PY{n}{current\PYZus{}state} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{choice}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} Start from a random state}
    \PY{n}{states}\PY{o}{=} \PY{p}{[}\PY{n}{current\PYZus{}state}\PY{p}{]}

    \PY{k}{for} \PY{n}{\PYZus{}} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}steps} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{n}{prob} \PY{o}{=} \PY{n}{transition\PYZus{}matrix}\PY{p}{[}\PY{n}{current\PYZus{}state}\PY{p}{]}
        \PY{n}{next\PYZus{}state} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{choice}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{p} \PY{o}{=} \PY{n}{prob}\PY{p}{)}
        \PY{n}{states}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{next\PYZus{}state}\PY{p}{)}
        \PY{n}{current\PYZus{}state} \PY{o}{=} \PY{n}{next\PYZus{}state}

    \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{states}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{nsample} \PY{o}{=} \PY{l+m+mi}{365} \PY{o}{*} \PY{l+m+mi}{100} \PY{c+c1}{\PYZsh{} number of days to simulate}
\PY{c+c1}{\PYZsh{} NOTE: EDIT BELOW to complete the transition matrix simulate}
\PY{n}{transition\PYZus{}matrix} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mf}{0.7}\PY{p}{,} \PY{l+m+mf}{0.3}\PY{p}{]}\PY{p}{,}
                              \PY{p}{[}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.7}\PY{p}{]}\PY{p}{]}\PY{p}{)}

\PY{n}{weather\PYZus{}mc} \PY{o}{=} \PY{n}{markov\PYZus{}chain\PYZus{}simulation}\PY{p}{(}\PY{n}{transition\PYZus{}matrix}\PY{p}{,} \PY{n}{nsample}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{n}{seed}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Validate the overall fraction of rainy days}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fraction of rainy days (Markov chain): }\PY{l+s+si}{\PYZob{}}\PY{n}{weather\PYZus{}mc}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{l+s+si}{:}\PY{l+s+s1}{.4\PYZpc{}}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Fraction of rainy days (Markov chain): 51.1836\%
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{9}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Get the lengths of consecutive rainy days}
\PY{n}{rainy\PYZus{}lengths\PYZus{}mc} \PY{o}{=} \PY{n}{consecutive\PYZus{}ones}\PY{p}{(}\PY{n}{weather\PYZus{}mc}\PY{p}{)}

\PY{c+c1}{\PYZsh{} NOTE: EDIT BELOW to compute the expected number of floods per year}
\PY{n}{flood\PYZus{}events\PYZus{}mc} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{consecutive\PYZus{}ones}\PY{p}{(}\PY{n}{weather\PYZus{}mc}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mi}{7}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{flood\PYZus{}events\PYZus{}mc}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{n}{nsample} \PY{o}{/} \PY{l+m+mi}{365}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
6.72
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} NOTE: EDIT BELOW to plot the histogram of lengths of rainy day runs}
\PY{n}{bins} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{rainy\PYZus{}lengths\PYZus{}mc}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{hist}\PY{p}{(}
    \PY{n}{rainy\PYZus{}lengths\PYZus{}mc}\PY{p}{,} 
    \PY{n}{bins} \PY{o}{=} \PY{n}{bins}\PY{p}{,} 
    \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.6}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Markov Chain}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{density} \PY{o}{=} \PY{k+kc}{True}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Length of consecutive rainy days}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Probability density}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Histogram of consecutive rainy day lengths}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_02_files/Exercise_week_02_10_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subparagraph{Discussions}\label{discussions}

很明显地发现 Markov
链方法和之前随机生成的方法在降雨概率上分别并不大，但是对于连续降雨的估计要合理很多
(\(50\%\) 时间都在下雨的地方一年怎么可能只有不到两次洪水\ldots6
次相对来说更加合理).

    \paragraph{Question 1.3: Weather simulation with more
states}\label{question-1.3-weather-simulation-with-more-states}

Suppose the weather can be sunny (S), cloudy (C), or rainy (R). The
transition matrix is given by:

\[
T =
\begin{bmatrix}
P(S \to S) & P(S \to C) & P(S \to R) \\
P(C \to S) & P(C \to C) & P(C \to R) \\
P(R \to S) & P(R \to C) & P(R \to R)
\end{bmatrix}
=
\begin{bmatrix}
0.7 & 0.2 & 0.1 \\
0.3 & 0.5 & 0.2 \\
0.4 & 0.3 & 0.3
\end{bmatrix}
\]

We start with a sunny day.

\textbf{Tasks:} 1. Simulate the weather for 5 days. Run the simulation
with 100 different random seeds. What is the probability of having a
rainy day on the 5th day? 2. Simulate the weather for 100 days. Run the
simulation with 100 different random seeds. For each \(N\) in \{2, 5,
10, 20, 50, 100\}, plot the probabilities of being sunny, cloudy, and
rainy on the \(N\)-th day as functions of \(N\) with appropriate axes
scales. 3. Comment on the results.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Modify the Markov\PYZhy{}chain simulation for three states: sunny, cloudy, and rainy}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{markov\PYZus{}chain\PYZus{}simulation\PYZus{}3}\PY{p}{(}\PY{n}{transition\PYZus{}matrix}\PY{p}{,} \PY{n}{n\PYZus{}steps}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{42}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Markov\PYZhy{}chain Monte\PYZhy{}Carlo simulation of weather data with three states: }
\PY{l+s+sd}{        sunny (0), cloudy (1), and rainy(2).}
\PY{l+s+sd}{    Args:}
\PY{l+s+sd}{        transition\PYZus{}matrix (3x3 array): transition probabilities.}
\PY{l+s+sd}{        n\PYZus{}steps (int): Number of steps to simulate.}
\PY{l+s+sd}{        seed (int): Random seed for reproducibility.}
\PY{l+s+sd}{    Returns: weather sequence}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{rng} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{default\PYZus{}rng}\PY{p}{(}\PY{n}{seed}\PY{p}{)}
    \PY{n}{current\PYZus{}state} \PY{o}{=} \PY{l+m+mi}{0} \PY{c+c1}{\PYZsh{} Start from a sunny day}
    \PY{n}{states}\PY{o}{=} \PY{p}{[}\PY{n}{current\PYZus{}state}\PY{p}{]}

    \PY{k}{for} \PY{n}{\PYZus{}} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}steps} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{n}{prob} \PY{o}{=} \PY{n}{transition\PYZus{}matrix}\PY{p}{[}\PY{n}{current\PYZus{}state}\PY{p}{]}
        \PY{n}{next\PYZus{}state} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{choice}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{p} \PY{o}{=} \PY{n}{prob}\PY{p}{)}
        \PY{n}{states}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{next\PYZus{}state}\PY{p}{)}
        \PY{n}{current\PYZus{}state} \PY{o}{=} \PY{n}{next\PYZus{}state}

    \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{states}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{12}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{transition\PYZus{}matrix\PYZus{}3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mf}{0.7}\PY{p}{,} \PY{l+m+mf}{0.2}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}
                                \PY{p}{[}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{0.2}\PY{p}{]}\PY{p}{,}
                                \PY{p}{[}\PY{l+m+mf}{0.4}\PY{p}{,} \PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.3}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{n}{nsample} \PY{o}{=} \PY{l+m+mi}{5} \PY{c+c1}{\PYZsh{} number of days to simulate}
\PY{n}{seeds} \PY{o}{=} \PY{p}{[}\PY{n}{seed} \PY{o}{+} \PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{100}\PY{p}{)}\PY{p}{]} \PY{c+c1}{\PYZsh{} Different seeds based on student ID}
\PY{n}{is\PYZus{}rainy} \PY{o}{=} \PY{p}{[}\PY{p}{]} \PY{c+c1}{\PYZsh{} To store if the 5th day is rainy for each simulation}

\PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{seeds}\PY{p}{:}
    \PY{n}{weather\PYZus{}3} \PY{o}{=} \PY{n}{markov\PYZus{}chain\PYZus{}simulation\PYZus{}3}\PY{p}{(}\PY{n}{transition\PYZus{}matrix\PYZus{}3}\PY{p}{,} \PY{n}{nsample}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{n}{s}\PY{p}{)}
    \PY{n}{is\PYZus{}rainy}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{weather\PYZus{}3}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{)} \PY{c+c1}{\PYZsh{} Check if the 5th day is rainy}

\PY{c+c1}{\PYZsh{} NOTE: EDIT BELOW to compute the probability of rainy on the 5th day}
\PY{n}{rainy\PYZus{}prob} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{count\PYZus{}nonzero}\PY{p}{(}\PY{n}{is\PYZus{}rainy}\PY{p}{)} \PY{o}{/} \PY{n+nb}{len}\PY{p}{(}\PY{n}{is\PYZus{}rainy}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Probability of rainy on the 5th day: }\PY{l+s+si}{\PYZob{}}\PY{n}{rainy\PYZus{}prob}\PY{l+s+si}{:}\PY{l+s+s1}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Probability of rainy on the 5th day: 0.18
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{nsample} \PY{o}{=} \PY{l+m+mi}{100} \PY{c+c1}{\PYZsh{} number of days to simulate}
\PY{n}{days} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{200}\PY{p}{,} \PY{l+m+mi}{500}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{]}\PY{p}{)}
\PY{n}{weather\PYZus{}states} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{p}{]} \PY{k}{for} \PY{n}{\PYZus{}} \PY{o+ow}{in} \PY{n}{days}\PY{p}{]} \PY{c+c1}{\PYZsh{} To store weather states for different days}

\PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{seeds}\PY{p}{:}
    \PY{n}{weather\PYZus{}3} \PY{o}{=} \PY{n}{markov\PYZus{}chain\PYZus{}simulation\PYZus{}3}\PY{p}{(}\PY{n}{transition\PYZus{}matrix\PYZus{}3}\PY{p}{,} \PY{n}{nsample}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{n}{s}\PY{p}{)}
    \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{day} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{days}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} NOTE: EDIT HERE to append the weather state on the specified day}
        \PY{n}{weather\PYZus{}states}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{weather\PYZus{}3}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}

\PY{n}{sunny\PYZus{}probs} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{cloudy\PYZus{}probs} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{rainy\PYZus{}probs} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{k}{for} \PY{n}{states} \PY{o+ow}{in} \PY{n}{weather\PYZus{}states}\PY{p}{:}
    \PY{n}{states} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{states}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} NOTE: EDIT HERE and BELOW to compute the probabilities of different weather states}
    \PY{n}{sunny\PYZus{}probs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{count\PYZus{}nonzero}\PY{p}{(}\PY{n}{states} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{)} \PY{o}{/} \PY{n+nb}{len}\PY{p}{(}\PY{n}{states}\PY{p}{)}\PY{p}{)}
    \PY{n}{cloudy\PYZus{}probs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{count\PYZus{}nonzero}\PY{p}{(}\PY{n}{states} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{/} \PY{n+nb}{len}\PY{p}{(}\PY{n}{states}\PY{p}{)}\PY{p}{)}
    \PY{n}{rainy\PYZus{}probs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{count\PYZus{}nonzero}\PY{p}{(}\PY{n}{states} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{)} \PY{o}{/} \PY{n+nb}{len}\PY{p}{(}\PY{n}{states}\PY{p}{)}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{n}{sunny\PYZus{}probs}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{cloudy\PYZus{}probs}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{rainy\PYZus{}probs}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
[1.0, 0.67, 0.62, 0.54, 0.51, 0.46, 0.53, 0.45, 0.53]
[0.0, 0.2, 0.26, 0.34, 0.31, 0.37, 0.31, 0.42, 0.34]
[0.0, 0.13, 0.12, 0.12, 0.18, 0.17, 0.16, 0.13, 0.13]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{14}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} NOTE: EDIT BELOW to plot the probabilities of different weather states on different days}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
    \PY{n}{days}\PY{p}{,}
    \PY{n}{sunny\PYZus{}probs}\PY{p}{,}
    \PY{n}{marker} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sunny Probability}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
    \PY{n}{days}\PY{p}{,}
    \PY{n}{cloudy\PYZus{}probs}\PY{p}{,}
    \PY{n}{marker} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cloudy Probability}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
    \PY{n}{days}\PY{p}{,}
    \PY{n}{rainy\PYZus{}probs}\PY{p}{,}
    \PY{n}{marker} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rainy Probability}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Probability}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weather State Probabilities vs Day}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_02_files/Exercise_week_02_16_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subparagraph{Discussions}\label{discussions}

我们所看到的结果仍然是合理的：在矩阵中出现概率更高的晴天一开始概率最高，后来随着模拟天数的增加逐渐减少；雨天和多云逐渐变多.
当然，模拟得到的结果会有随机性，这体现在曲线中间出现的一些弯折上.

    \subsubsection{Exercise 2: Stellar evolution
simulation}\label{exercise-2-stellar-evolution-simulation}

A typical solar-mass star evolves through four stages: young (Y), main
sequence (M), red giant (R), and white dwarf (W; resulting from
supernova explosion). The transition matrix over a 10-million-year
interval is given by (do not take the values too seriously; I made them
up for this exercise):

\[
T = \begin{bmatrix}
P(Y \to Y) & P(Y \to M) & P(Y \to R) & P(Y \to W) \\
P(M \to Y) & P(M \to M) & P(M \to R) & P(M \to W) \\
P(R \to Y) & P(R \to M) & P(R \to R) & P(R \to W) \\
P(W \to Y) & P(W \to M) & P(W \to R) & P(W \to W)
\end{bmatrix}
= \begin{bmatrix}
0.5 & 0.5 & 0 & 0 \\
0 & 0.99 & 0.01 & 0 \\
0 & 0 & 0.9 & 0.1 \\
0 & 0 & 0 & 1
\end{bmatrix}
\]

\paragraph{Question 2.1: stellar age}\label{question-2.1-stellar-age}

\textbf{Task:} Simulate the life cycle of 1000 stars, and estimate the
average age of a solar-mass star when it becomes a white dwarf using the
4-state Markov model.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{15}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{markov\PYZus{}chain\PYZus{}simulation\PYZus{}star}\PY{p}{(}\PY{n}{transition\PYZus{}matrix}\PY{p}{,} \PY{n}{n\PYZus{}steps}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{42}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Markov\PYZhy{}chain Monte\PYZhy{}Carlo simulation of stellar evolution with four states: }
\PY{l+s+sd}{        0 = Young, 1 = Main Sequence, 2 = Red Giant, 3 = White Dwarf.}
\PY{l+s+sd}{    Args:}
\PY{l+s+sd}{        transition\PYZus{}matrix (4x4 array): transition probabilities.}
\PY{l+s+sd}{        n\PYZus{}steps (int): Number of steps to simulate.}
\PY{l+s+sd}{        seed (int): Random seed for reproducibility.}
\PY{l+s+sd}{    Returns: }
\PY{l+s+sd}{        stellar state sequence, with states represented as integers 0, 1, 2, 3.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{rng} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{default\PYZus{}rng}\PY{p}{(}\PY{n}{seed}\PY{p}{)}
    \PY{n}{current\PYZus{}state} \PY{o}{=} \PY{l+m+mi}{0} \PY{c+c1}{\PYZsh{} Start as young star}
    \PY{n}{states} \PY{o}{=} \PY{p}{[}\PY{n}{current\PYZus{}state}\PY{p}{]}
    
    \PY{c+c1}{\PYZsh{} NOTE: EDIT BELOW to complete the function}
    \PY{k}{for} \PY{n}{\PYZus{}} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}steps} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{n}{prob} \PY{o}{=} \PY{n}{transition\PYZus{}matrix}\PY{p}{[}\PY{n}{current\PYZus{}state}\PY{p}{]}
        \PY{n}{next\PYZus{}state} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{choice}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,} \PY{n}{p} \PY{o}{=} \PY{n}{prob}\PY{p}{)}
        \PY{n}{states}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{next\PYZus{}state}\PY{p}{)}
        \PY{n}{current\PYZus{}state} \PY{o}{=} \PY{n}{next\PYZus{}state}
    
    \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{states}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{stellar\PYZus{}age}\PY{p}{(}\PY{n}{states}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Calculate the age of a star based on its state sequence.}
\PY{l+s+sd}{    Args:}
\PY{l+s+sd}{        states (array): Sequence of stellar states.}
\PY{l+s+sd}{    Returns: }
\PY{l+s+sd}{        age of the star in million years; }
\PY{l+s+sd}{        \PYZhy{}1 if it never becomes a white dwarf}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{c+c1}{\PYZsh{} First occurrence of state 3 (white dwarf)}
    \PY{n}{i} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{searchsorted}\PY{p}{(}\PY{n}{states}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{side}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{if} \PY{n}{i} \PY{o}{\PYZlt{}} \PY{n+nb}{len}\PY{p}{(}\PY{n}{states}\PY{p}{)} \PY{o+ow}{and} \PY{n}{states}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{3}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} Age in million years}
        \PY{k}{return} \PY{p}{(}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{10}
    \PY{k}{else}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} Never becomes a white dwarf}
        \PY{k}{return} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{stellar\PYZus{}transition\PYZus{}matrix} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{,}
                                      \PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{0.99}\PY{p}{,} \PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{,}
                                      \PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{0.9}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}
                                      \PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{]}\PY{p}{)}

\PY{n}{nsample} \PY{o}{=} \PY{l+m+mi}{1000} \PY{c+c1}{\PYZsh{} number of stars to simulate}
\PY{n}{seeds} \PY{o}{=} \PY{p}{[}\PY{n}{seed} \PY{o}{+} \PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{nsample}\PY{p}{)}\PY{p}{]} \PY{c+c1}{\PYZsh{} Different seeds based on student ID}
\PY{n}{max\PYZus{}steps} \PY{o}{=} \PY{l+m+mi}{1000} \PY{c+c1}{\PYZsh{} Maximum number of steps to simulate for each star}
\PY{n}{stellar\PYZus{}states} \PY{o}{=} \PY{p}{[}\PY{p}{]} \PY{c+c1}{\PYZsh{} To store the states of all stars}

\PY{c+c1}{\PYZsh{} Simulate the evolution of multiple stars}
\PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{seeds}\PY{p}{:}
    \PY{n}{states} \PY{o}{=} \PY{n}{markov\PYZus{}chain\PYZus{}simulation\PYZus{}star}\PY{p}{(}\PY{n}{stellar\PYZus{}transition\PYZus{}matrix}\PY{p}{,} \PY{n}{max\PYZus{}steps}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{n}{s}\PY{p}{)}
    \PY{n}{stellar\PYZus{}states}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{states}\PY{p}{)}

\PY{n}{stellar\PYZus{}states} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{stellar\PYZus{}states}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{18}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Compute the ages of all stars}
\PY{n}{ages} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{stellar\PYZus{}age}\PY{p}{(}\PY{n}{states}\PY{p}{)} \PY{k}{for} \PY{n}{states} \PY{o+ow}{in} \PY{n}{stellar\PYZus{}states}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} NOTE: EDIT BELOW to compute the average age; pay attention to stars that never become white dwarfs}
\PY{c+c1}{\PYZsh{} Only consider stars that became white dwarfs (age != \PYZhy{}1)}
\PY{n}{valid\PYZus{}ages} \PY{o}{=} \PY{n}{ages}\PY{p}{[}\PY{n}{ages} \PY{o}{!=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{average\PYZus{}age} \PY{o}{=} \PY{n}{valid\PYZus{}ages}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Average age when becoming a white dwarf: }\PY{l+s+si}{\PYZob{}}\PY{n}{average\PYZus{}age}\PY{l+s+si}{:}\PY{l+s+s1}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ million years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Average age when becoming a white dwarf: 1173.86 million years
    \end{Verbatim}

    \paragraph{Question 2.2: Stellar stage
composition}\label{question-2.2-stellar-stage-composition}

\textbf{Task:} For the 1000 stars simulated in Question 2.1, plot the
porportion of stars in each stage (Y, M, R, W) as a function of time (up
to 10 billion years). Use appropriate axes scales.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{19}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Compute the fractions of stars in each stage over time}
\PY{n}{fractions} \PY{o}{=} \PY{p}{(}\PY{n}{stellar\PYZus{}states}\PY{p}{[}\PY{o}{.}\PY{o}{.}\PY{o}{.}\PY{p}{,} \PY{k+kc}{None}\PY{p}{]} \PY{o}{==} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{fracY}\PY{p}{,} \PY{n}{fracM}\PY{p}{,} \PY{n}{fracR}\PY{p}{,} \PY{n}{fracW} \PY{o}{=} \PY{n}{fractions}\PY{o}{.}\PY{n}{T}

\PY{c+c1}{\PYZsh{} NOTE: EDIT BELOW to plot the fractions of stars in different stages over time}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
    \PY{n}{fracY}\PY{p}{,}
    \PY{n}{marker} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{young}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.6}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
    \PY{n}{fracM}\PY{p}{,}
    \PY{n}{marker} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{main sequence}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.6}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
    \PY{n}{fracR}\PY{p}{,}
    \PY{n}{marker} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{red giant}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.6}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
    \PY{n}{fracW}\PY{p}{,}
    \PY{n}{marker} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{white dwarf}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.6}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ages of stars}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fractions of stars in different state}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{the fractions of stars in different stages over time}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_02_files/Exercise_week_02_24_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{Question 2.3: Stellar population with continuous
formation}\label{question-2.3-stellar-population-with-continuous-formation}

Assume that 1000 stars have formed at a constant rate over the past 10
billion years, i.e., the birth times of the stars can be drawn from a
uniform distribution between 0 and 10 billion years.

\textbf{Task:} Compute the present-day (10 billion years after the first
stellar birth) proportions of stars in each stage (Y, M, R, W) in this
population.

\textbf{Hint:} Can you complete this task without running a new
simulation?

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{20}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rng} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{default\PYZus{}rng}\PY{p}{(}\PY{n}{seed} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{birth\PYZus{}times} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{integers}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{,} \PY{n}{size} \PY{o}{=} \PY{n}{nsample}\PY{p}{)}   \PY{c+c1}{\PYZsh{} Birth times of stars (unit: 10 million years)}
\PY{n}{today} \PY{o}{=} \PY{l+m+mi}{1000}        \PY{c+c1}{\PYZsh{} Present time (unit: 10 million years)}

\PY{c+c1}{\PYZsh{} Use the birth times to determine the current states of the stars}
\PY{n}{mask} \PY{o}{=} \PY{n}{birth\PYZus{}times} \PY{o}{\PYZlt{}} \PY{n}{today}
\PY{n}{ages} \PY{o}{=} \PY{n}{today} \PY{o}{\PYZhy{}} \PY{n}{birth\PYZus{}times}\PY{p}{[}\PY{n}{mask}\PY{p}{]}
\PY{n}{present\PYZus{}states} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{stellar\PYZus{}states}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{n}{age} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]} \PY{k}{if} \PY{n}{age} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1} \PY{o}{\PYZlt{}} \PY{n}{max\PYZus{}steps} \PY{k}{else} \PY{l+m+mi}{3} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{age} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{mask}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{ages}\PY{p}{)}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} NOTE: EDIT BELOW to print the present\PYZhy{}day proportions of stars in different stages}
\PY{n}{unique}\PY{p}{,} \PY{n}{counts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{n}{present\PYZus{}states}\PY{p}{,} \PY{n}{return\PYZus{}counts} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
\PY{n}{stage\PYZus{}labels} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Young}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Main Sequence}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Red Giant}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{White Dwarf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{proportions} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n}{proportions}\PY{p}{[}\PY{n}{unique}\PY{p}{]} \PY{o}{=} \PY{n}{counts} \PY{o}{/} \PY{n+nb}{len}\PY{p}{(}\PY{n}{present\PYZus{}states}\PY{p}{)}

\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{label} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{stage\PYZus{}labels}\PY{p}{)}\PY{p}{:}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{label}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{: }\PY{l+s+si}{\PYZob{}}\PY{n}{proportions}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s2}{.1\PYZpc{}}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Young: 0.2\%
Main Sequence: 10.5\%
Red Giant: 0.9\%
White Dwarf: 88.4\%
    \end{Verbatim}

    \subsubsection{Exercise 3: Transient
detection}\label{exercise-3-transient-detection}

A special type of astronomical transient event (e.g., a supernova
explosion) starts on a random night of an observing season with 180
nights in total. The transient event lasts for \(D\) consecutive nights
and is only \textbf{confirmed} if it is observed in two consecutive
nights within its duration.

\paragraph{Question 3.1: Detection probability with independent
nights}\label{question-3.1-detection-probability-with-independent-nights}

Assume each night is independently clear (observable) with a probability
of 0.6.

\textbf{Task:} For each \(D\) in \(\{2,4,8,12,16,20\}\), simulate 10,000
observing seasons and estimate the probability of confirming the
transient event. Plot the detection probability as a function of \(D\)
with appropriate axes scales.

\textbf{Hint:} You may generate a binary random number sequence to
represent clear and unusable nights, e.g., 0 for unusable and 1 for
clear, then check if there are two consecutive 1s within the \(D\)
nights starting from a random night.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{21}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{durations} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{16}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{]}

\PY{k}{def}\PY{+w}{ }\PY{n+nf}{generate\PYZus{}random\PYZus{}transient\PYZus{}event}\PY{p}{(}\PY{n}{duration}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{42}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}generate a random transient event during one observing season of 180 nights:}
\PY{l+s+sd}{    Args: }
\PY{l+s+sd}{        duration (int): the duration of a transient event.}
\PY{l+s+sd}{        seed (int): Random seed for reproducibility.}
\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{        start\PYZus{}date (int): the starting date of a transient event.}
\PY{l+s+sd}{        end\PYZus{}date (int): the ending date of a transient event.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{rng\PYZus{}transient\PYZus{}event} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{default\PYZus{}rng}\PY{p}{(}\PY{n}{seed}\PY{p}{)}
    
    \PY{n}{start\PYZus{}date} \PY{o}{=} \PY{n}{rng\PYZus{}transient\PYZus{}event}\PY{o}{.}\PY{n}{integers}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{180} \PY{o}{\PYZhy{}} \PY{n}{duration}\PY{p}{)}
    \PY{n}{end\PYZus{}date} \PY{o}{=} \PY{n}{start\PYZus{}date} \PY{o}{+} \PY{n}{duration}
    
    \PY{k}{return} \PY{n}{start\PYZus{}date}\PY{p}{,} \PY{n}{end\PYZus{}date}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{22}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{generate\PYZus{}clear\PYZus{}nights}\PY{p}{(}\PY{n}{probability} \PY{o}{=} \PY{l+m+mf}{0.6}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{42}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}generate a binary random number sequence for clear and unusable nights with probability:}
\PY{l+s+sd}{        0 for unusable nights, 1 for clear nights.}
\PY{l+s+sd}{    Args:}
\PY{l+s+sd}{        probalbility (float): the probability of clear night.}
\PY{l+s+sd}{        seed (int): Random seed for reproducibility.}
\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{        nights sequence, with clear and unusable nights represented as 1, 0.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{rng\PYZus{}clear\PYZus{}night} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{default\PYZus{}rng}\PY{p}{(}\PY{n}{seed}\PY{p}{)}
    \PY{n}{nights} \PY{o}{=} \PY{n}{rng\PYZus{}clear\PYZus{}night}\PY{o}{.}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{180}\PY{p}{)}
    
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{180}\PY{p}{)}\PY{p}{:}
        \PY{k}{if} \PY{p}{(}\PY{n}{nights}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{probability}\PY{p}{)}\PY{p}{:}
            \PY{n}{nights}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1}
        \PY{k}{else}\PY{p}{:}
            \PY{n}{nights}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
    
    \PY{k}{return} \PY{n}{nights}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{23}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{detection\PYZus{}probabilities} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{k}{for} \PY{n}{duration} \PY{o+ow}{in} \PY{n}{durations}\PY{p}{:}
    \PY{n}{success\PYZus{}observation} \PY{o}{=} \PY{l+m+mi}{0}
    
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{10000}\PY{p}{)}\PY{p}{:}
        \PY{n}{start\PYZus{}date}\PY{p}{,} \PY{n}{end\PYZus{}date} \PY{o}{=} \PY{n}{generate\PYZus{}random\PYZus{}transient\PYZus{}event}\PY{p}{(}\PY{n}{duration}\PY{p}{,} \PY{n}{seed} \PY{o}{+} \PY{n}{i}\PY{p}{)}
        \PY{n}{nights} \PY{o}{=} \PY{n}{generate\PYZus{}clear\PYZus{}nights}\PY{p}{(}\PY{n}{probability} \PY{o}{=} \PY{l+m+mf}{0.6}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{n}{seed} \PY{o}{+} \PY{n}{i}\PY{p}{)}
        \PY{n}{num\PYZus{}clear} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{count\PYZus{}nonzero}\PY{p}{(}\PY{n}{nights}\PY{p}{[}\PY{n}{start\PYZus{}date}\PY{p}{:}\PY{n}{end\PYZus{}date}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{k}{if} \PY{p}{(}\PY{n}{num\PYZus{}clear} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
            \PY{n}{success\PYZus{}observation} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
        
    \PY{n}{detection\PYZus{}probabilities}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{success\PYZus{}observation} \PY{o}{/} \PY{l+m+mi}{10000}\PY{p}{)}
    
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
    \PY{n}{durations}\PY{p}{,}
    \PY{n}{detection\PYZus{}probabilities}\PY{p}{,}
    \PY{n}{marker} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Detection probability}\PY{l+s+s2}{\PYZdq{}}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration of transient event}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Probability of successful detection}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{detection probabilities for different duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_02_files/Exercise_week_02_30_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{Question 3.2: Detection probability with correlated
weather}\label{question-3.2-detection-probability-with-correlated-weather}

The weather conditions are correlated in time. For example, a clear
night is more likely to be followed by another clear night. We can model
the weather as a two-state Markov chain with the following transition
matrix:

\[
T = 
\begin{bmatrix}
P(U \to U) & P(U \to C) \\
P(C \to U) & P(C \to C)
\end{bmatrix}
= \begin{bmatrix}
0.7 & 0.3 \\
0.2 & 0.8
\end{bmatrix}
\]

where \(U\) and \(C\) denote unusable and clear nights, respectively.
\(P(U \to U)\) is the probability of an unusable night being followed by
another unusable night, and so on.

\textbf{Task:} Repeat Question 3.1 using the Markov chain model to
simulate the weather. Confirm that the steady-state probability of clear
nights is still 0.6. Compare your transient detection probability
results with those from Question 3.1.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{24}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{generate\PYZus{}clear\PYZus{}nights\PYZus{}mc}\PY{p}{(}\PY{n}{transition\PYZus{}matrix\PYZus{}question\PYZus{}3}\PY{p}{,} \PY{n}{num\PYZus{}steps}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{42}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}generate a binary random number sequence for clear and unusable nights with markov chain method:}
\PY{l+s+sd}{        0 for unusable nights, 1 for clear nights.}
\PY{l+s+sd}{    Args:}
\PY{l+s+sd}{        transition\PYZus{}matrix\PYZus{}uc (2x2 array): transition probabilities.}
\PY{l+s+sd}{        num\PYZus{}steps (int): the total steps of Markov chain.}
\PY{l+s+sd}{        seed (int): Random seed for reproducibility.}
\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{        nights sequence, with clear and unusable nights represented as 1, 0.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{rng\PYZus{}clear\PYZus{}night\PYZus{}mc} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{default\PYZus{}rng}\PY{p}{(}\PY{n}{seed}\PY{p}{)}
    \PY{n}{current\PYZus{}night\PYZus{}mc} \PY{o}{=} \PY{n}{rng\PYZus{}clear\PYZus{}night\PYZus{}mc}\PY{o}{.}\PY{n}{choice}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} Start from a random state}
    \PY{n}{nights\PYZus{}mc} \PY{o}{=} \PY{p}{[}\PY{n}{current\PYZus{}night\PYZus{}mc}\PY{p}{]}

    \PY{k}{for} \PY{n}{\PYZus{}} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}steps} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{n}{prob} \PY{o}{=} \PY{n}{transition\PYZus{}matrix\PYZus{}question\PYZus{}3}\PY{p}{[}\PY{n}{current\PYZus{}night\PYZus{}mc}\PY{p}{]}
        \PY{n}{next\PYZus{}night\PYZus{}mc} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{choice}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{p} \PY{o}{=} \PY{n}{prob}\PY{p}{)}
        \PY{n}{nights\PYZus{}mc}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{next\PYZus{}night\PYZus{}mc}\PY{p}{)}
        \PY{n}{current\PYZus{}night\PYZus{}mc} \PY{o}{=} \PY{n}{next\PYZus{}night\PYZus{}mc}

    \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{nights\PYZus{}mc}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{25}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{detection\PYZus{}probabilities\PYZus{}mc} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{transition\PYZus{}matrix\PYZus{}question\PYZus{}3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mf}{0.7}\PY{p}{,} \PY{l+m+mf}{0.3}\PY{p}{]}\PY{p}{,}
                                         \PY{p}{[}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{l+m+mf}{0.8}\PY{p}{]}\PY{p}{]}\PY{p}{)}

\PY{k}{for} \PY{n}{duration} \PY{o+ow}{in} \PY{n}{durations}\PY{p}{:}
    \PY{n}{success\PYZus{}observation} \PY{o}{=} \PY{l+m+mi}{0}
    
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{10000}\PY{p}{)}\PY{p}{:}
        \PY{n}{start\PYZus{}date}\PY{p}{,} \PY{n}{end\PYZus{}date} \PY{o}{=} \PY{n}{generate\PYZus{}random\PYZus{}transient\PYZus{}event}\PY{p}{(}\PY{n}{duration}\PY{p}{,} \PY{n}{seed} \PY{o}{+} \PY{n}{i}\PY{p}{)}
        \PY{n}{nights} \PY{o}{=} \PY{n}{generate\PYZus{}clear\PYZus{}nights\PYZus{}mc}\PY{p}{(}\PY{n}{transition\PYZus{}matrix\PYZus{}question\PYZus{}3}\PY{p}{,} \PY{n}{num\PYZus{}steps} \PY{o}{=} \PY{l+m+mi}{180}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{n}{seed} \PY{o}{+} \PY{n}{i}\PY{p}{)}
        \PY{n}{num\PYZus{}clear} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{count\PYZus{}nonzero}\PY{p}{(}\PY{n}{nights}\PY{p}{[}\PY{n}{start\PYZus{}date}\PY{p}{:}\PY{n}{end\PYZus{}date}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{k}{if} \PY{p}{(}\PY{n}{num\PYZus{}clear} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
            \PY{n}{success\PYZus{}observation} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
        
    \PY{n}{detection\PYZus{}probabilities\PYZus{}mc}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{success\PYZus{}observation} \PY{o}{/} \PY{l+m+mi}{10000}\PY{p}{)}
    
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
    \PY{n}{durations}\PY{p}{,}
    \PY{n}{detection\PYZus{}probabilities\PYZus{}mc}\PY{p}{,}
    \PY{n}{marker} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Detection probability (Markov chain)}\PY{l+s+s2}{\PYZdq{}}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration of transient event}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Probability of successful detection (Markov chain)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{detection probabilities for different duration (Markov chain)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_02_files/Exercise_week_02_33_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{Question 3.3: Detection probability with cadence
gaps}\label{question-3.3-detection-probability-with-cadence-gaps}

Not all clear nights are usable for transient detection due to various
reasons (e.g., the moon is too bright). Assume that in every 29 nights,
the first 5 nights are unusable for transient detection (even if the
skies are clear).

\textbf{Task:} Repeat Question 3.2 with this additional constraint.
Compare your results with those from Question 3.2. Comment on all your
results.

\textbf{Hint:} You may use the modulo operator (\texttt{\%}) to identify
the nights that are unusable for transient detection, or use a
predefined mask array to represent the cadence gaps. You do not have to
rerun the weather simulation; just apply the cadence gaps to the results
from Question 3.2.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{26}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{generate\PYZus{}clear\PYZus{}nights\PYZus{}mc\PYZus{}gaps}\PY{p}{(}\PY{n}{transition\PYZus{}matrix\PYZus{}question\PYZus{}3\PYZus{}gaps}\PY{p}{,} \PY{n}{num\PYZus{}steps}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{42}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}generate a binary random number sequence for clear and unusable nights with markov chain method, considering the gaps:}
\PY{l+s+sd}{        0 for unusable nights, 1 for clear nights.}
\PY{l+s+sd}{    Args:}
\PY{l+s+sd}{        transition\PYZus{}matrix\PYZus{}uc (2x2 array): transition probabilities.}
\PY{l+s+sd}{        num\PYZus{}steps (int): the total steps of Markov chain.}
\PY{l+s+sd}{        seed (int): Random seed for reproducibility.}
\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{        nights sequence, with clear and unusable nights represented as 1, 0.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{rng\PYZus{}clear\PYZus{}night\PYZus{}mc\PYZus{}gaps} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{default\PYZus{}rng}\PY{p}{(}\PY{n}{seed}\PY{p}{)}
    \PY{n}{current\PYZus{}night\PYZus{}mc\PYZus{}gaps} \PY{o}{=} \PY{n}{rng\PYZus{}clear\PYZus{}night\PYZus{}mc\PYZus{}gaps}\PY{o}{.}\PY{n}{choice}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} Start from a random state}
    \PY{n}{nights\PYZus{}mc\PYZus{}gaps} \PY{o}{=} \PY{p}{[}\PY{n}{current\PYZus{}night\PYZus{}mc\PYZus{}gaps}\PY{p}{]}

    \PY{k}{for} \PY{n}{\PYZus{}} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}steps} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{n}{prob} \PY{o}{=} \PY{n}{transition\PYZus{}matrix\PYZus{}question\PYZus{}3\PYZus{}gaps}\PY{p}{[}\PY{n}{current\PYZus{}night\PYZus{}mc\PYZus{}gaps}\PY{p}{]}
        \PY{n}{next\PYZus{}night\PYZus{}mc\PYZus{}gaps} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{choice}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{p} \PY{o}{=} \PY{n}{prob}\PY{p}{)}
        \PY{n}{nights\PYZus{}mc\PYZus{}gaps}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{next\PYZus{}night\PYZus{}mc\PYZus{}gaps}\PY{p}{)}
        \PY{n}{current\PYZus{}night\PYZus{}mc\PYZus{}gaps} \PY{o}{=} \PY{n}{next\PYZus{}night\PYZus{}mc\PYZus{}gaps}
        
    \PY{c+c1}{\PYZsh{} the first 5 nights of 29 nights are unusable}
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{num\PYZus{}steps}\PY{p}{)}\PY{p}{:}
        \PY{k}{if} \PY{n}{i} \PY{o}{\PYZpc{}} \PY{l+m+mi}{29} \PY{o}{\PYZlt{}} \PY{l+m+mi}{5}\PY{p}{:}
            \PY{n}{nights\PYZus{}mc\PYZus{}gaps}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}

    \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{nights\PYZus{}mc\PYZus{}gaps}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{27}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{detection\PYZus{}probabilities\PYZus{}mc\PYZus{}gaps} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{transition\PYZus{}matrix\PYZus{}question\PYZus{}3\PYZus{}gaps} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mf}{0.7}\PY{p}{,} \PY{l+m+mf}{0.3}\PY{p}{]}\PY{p}{,}
                                              \PY{p}{[}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{l+m+mf}{0.8}\PY{p}{]}\PY{p}{]}\PY{p}{)}

\PY{k}{for} \PY{n}{duration} \PY{o+ow}{in} \PY{n}{durations}\PY{p}{:}
    \PY{n}{success\PYZus{}observation\PYZus{}gaps} \PY{o}{=} \PY{l+m+mi}{0}
    
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{10000}\PY{p}{)}\PY{p}{:}
        \PY{n}{start\PYZus{}date\PYZus{}gaps}\PY{p}{,} \PY{n}{end\PYZus{}date\PYZus{}gaps} \PY{o}{=} \PY{n}{generate\PYZus{}random\PYZus{}transient\PYZus{}event}\PY{p}{(}\PY{n}{duration}\PY{p}{,} \PY{n}{seed} \PY{o}{+} \PY{n}{i}\PY{p}{)}
        \PY{n}{nights\PYZus{}gaps} \PY{o}{=} \PY{n}{generate\PYZus{}clear\PYZus{}nights\PYZus{}mc\PYZus{}gaps}\PY{p}{(}\PY{n}{transition\PYZus{}matrix\PYZus{}question\PYZus{}3\PYZus{}gaps}\PY{p}{,} \PY{n}{num\PYZus{}steps} \PY{o}{=} \PY{l+m+mi}{180}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{n}{seed} \PY{o}{+} \PY{n}{i}\PY{p}{)}
        \PY{n}{num\PYZus{}clear\PYZus{}gaps} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{count\PYZus{}nonzero}\PY{p}{(}\PY{n}{nights\PYZus{}gaps}\PY{p}{[}\PY{n}{start\PYZus{}date\PYZus{}gaps}\PY{p}{:}\PY{n}{end\PYZus{}date\PYZus{}gaps}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{k}{if} \PY{p}{(}\PY{n}{num\PYZus{}clear\PYZus{}gaps} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
            \PY{n}{success\PYZus{}observation\PYZus{}gaps} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
        
    \PY{n}{detection\PYZus{}probabilities\PYZus{}mc\PYZus{}gaps}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{success\PYZus{}observation\PYZus{}gaps} \PY{o}{/} \PY{l+m+mi}{10000}\PY{p}{)}
    
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
    \PY{n}{durations}\PY{p}{,}
    \PY{n}{detection\PYZus{}probabilities\PYZus{}mc\PYZus{}gaps}\PY{p}{,}
    \PY{n}{marker} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Detection probability (Markov chain with gaps)}\PY{l+s+s2}{\PYZdq{}}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration of transient event}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Probability of successful detection (Markov chain with gaps)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{detection probabilities for different duration (Markov chain with gaps)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_02_files/Exercise_week_02_36_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{28}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
    \PY{n}{durations}\PY{p}{,}
    \PY{n}{detection\PYZus{}probabilities}\PY{p}{,}
    \PY{n}{marker} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Detection probability}\PY{l+s+s2}{\PYZdq{}}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
    \PY{n}{durations}\PY{p}{,}
    \PY{n}{detection\PYZus{}probabilities\PYZus{}mc}\PY{p}{,}
    \PY{n}{marker} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Detection probability (Markov chain)}\PY{l+s+s2}{\PYZdq{}}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
    \PY{n}{durations}\PY{p}{,}
    \PY{n}{detection\PYZus{}probabilities\PYZus{}mc\PYZus{}gaps}\PY{p}{,}
    \PY{n}{marker} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Detection probability (Markov chain with gaps)}\PY{l+s+s2}{\PYZdq{}}
\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration of transient event}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Probability of successful detection}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Detection probabilities for different duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Exercise_week_02_files/Exercise_week_02_37_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subparagraph{Discussions}\label{discussions}

定性上，还是 duration 越长，能够成功探测到的概率越大.
其实这个「每月前五天无法成功观测」的限制只是在整体上降低了概率，并没有影响整体的趋势.

    \subsubsection{Note: steps for submitting the
exercise}\label{note-steps-for-submitting-the-exercise}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  In the menu bar, select \texttt{File\ \textgreater{}\ Download} to
  download your notebook as a \texttt{.ipynb} file.
\item
  Select
  \texttt{File\ \textgreater{}\ Save\ and\ Export\ Notebook\ As\ \textgreater{}\ PDF}
  to export your notebook as a PDF file.
\item
  Combine the \texttt{.ipynb} and \texttt{.pdf} files into a single
  \texttt{.zip} or \texttt{.tar.gz} archive.
\item
  Upload your archive to the web learning platform (网络学堂).
\end{enumerate}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
